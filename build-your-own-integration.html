<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Build Your Own Integrations | ImmyDocs</title>
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.efe19a0a.css" as="style"><link rel="preload" href="/assets/js/app.211bfa0f.js" as="script"><link rel="preload" href="/assets/js/3.b0bc7a00.js" as="script"><link rel="preload" href="/assets/js/19.14059d57.js" as="script"><link rel="prefetch" href="/assets/js/10.4de5c5a8.js"><link rel="prefetch" href="/assets/js/11.1241c6c8.js"><link rel="prefetch" href="/assets/js/12.c46ab272.js"><link rel="prefetch" href="/assets/js/13.84827c0d.js"><link rel="prefetch" href="/assets/js/14.8edb1b6f.js"><link rel="prefetch" href="/assets/js/15.1e512f24.js"><link rel="prefetch" href="/assets/js/16.1fe95300.js"><link rel="prefetch" href="/assets/js/17.72f41ada.js"><link rel="prefetch" href="/assets/js/18.ec46397e.js"><link rel="prefetch" href="/assets/js/20.f2a70216.js"><link rel="prefetch" href="/assets/js/21.d20f9011.js"><link rel="prefetch" href="/assets/js/22.e1a19553.js"><link rel="prefetch" href="/assets/js/23.6ecffca8.js"><link rel="prefetch" href="/assets/js/24.7969d155.js"><link rel="prefetch" href="/assets/js/4.c281ac49.js"><link rel="prefetch" href="/assets/js/5.cee7d83d.js"><link rel="prefetch" href="/assets/js/6.9cac2250.js"><link rel="prefetch" href="/assets/js/7.22718433.js"><link rel="prefetch" href="/assets/js/8.057acf71.js"><link rel="prefetch" href="/assets/js/9.66bcac9c.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.c67f3c8d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.efe19a0a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">ImmyDocs</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div> <a href="https://github.com/immense/immybot-documentation" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div> <a href="https://github.com/immense/immybot-documentation" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>What's New</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/releases.html" class="sidebar-link">0.58.0</a></li></ul></section></li><li><a href="/" aria-current="page" class="sidebar-link">Getting Started</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/#preface" class="sidebar-link">Preface</a></li><li class="sidebar-sub-header"><a href="/#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/#create-your-trial-instance" class="sidebar-link">Create your trial instance</a></li><li class="sidebar-sub-header"><a href="/#setup-your-first-computer" class="sidebar-link">Setup your first Computer</a></li><li class="sidebar-sub-header"><a href="/#recommended-deployments" class="sidebar-link">Recommended Deployments</a></li><li class="sidebar-sub-header"><a href="/#testing-with-windows-sandbox" class="sidebar-link">Testing with Windows Sandbox</a></li><li class="sidebar-sub-header"><a href="/#adding-users" class="sidebar-link">Adding Users</a></li><li class="sidebar-sub-header"><a href="/#user-roles" class="sidebar-link">User Roles</a></li><li class="sidebar-sub-header"><a href="/#terminology" class="sidebar-link">Terminology</a></li><li class="sidebar-sub-header"><a href="/#deployment-resolution" class="sidebar-link">Deployment Resolution</a></li><li class="sidebar-sub-header"><a href="/#identification-failures" class="sidebar-link">Identification Failures</a></li><li class="sidebar-sub-header"><a href="/#pending-computers" class="sidebar-link">Pending Computers</a></li><li class="sidebar-sub-header"><a href="/#security-software-exclusions" class="sidebar-link">Security Software Exclusions</a></li></ul></li><li><a href="/FAQ.html" class="sidebar-link">Frequently Asked Questions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/FAQ.html#do-i-need-a-separate-usb-installer-per-tenant" class="sidebar-link">Do I need a separate USB/Installer per tenant?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#will-immybot-start-doing-anything-without-my-consent-like-when-i-save-a-deployment-will-it-automatically-deploy" class="sidebar-link">Will ImmyBot start doing anything without my consent? Like when I save a deployment, will it automatically deploy?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#what-if-i-don-t-know-which-user-will-be-using-the-computer" class="sidebar-link">What if I don’t know which user will be using the computer?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#can-immy-join-azuread" class="sidebar-link">Can Immy join AzureAD?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#my-azuread-join-action-is-failing-what-are-some-common-fixes" class="sidebar-link">My AzureAD Join action is failing, what are some common fixes?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#can-immy-make-deploying-via-intune-more-simple" class="sidebar-link">Can Immy make deploying via Intune more simple?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#can-immy-help-migrate-my-customers-to-azuread-from-on-premises-environments" class="sidebar-link">Can Immy help migrate my customers to AzureAD from On-Premises environments?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#domain-join-didn-t-work-what-gives" class="sidebar-link">Domain Join didn’t work, what gives?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#why-are-my-computers-stuck-in-identification" class="sidebar-link">Why are my computers stuck in Identification</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#can-you-target-devices-in-azure-groups" class="sidebar-link">Can you target devices in Azure Groups?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#how-do-i-uninstall-the-immyagent" class="sidebar-link">How do I uninstall the ImmyAgent?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#how-are-we-able-to-define-which-version-of-windows-is-installed-during-the-initial-setup" class="sidebar-link">How/are we able to define which version of Windows is installed during the initial setup?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#since-immy-bot-doesn-t-use-an-iso-does-it-require-a-device-to-have-the-ability-to-have-2-usb-devices-plugged-in-one-for-a-windows-iso-and-one-for-the-immybot-ppkg" class="sidebar-link">Since Immy.Bot doesn’t use an ISO, does it require a device to have the ability to have 2 USB devices plugged in? One for a Windows ISO and one for the ImmyBot ppkg?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#does-immy-rely-on-the-windows-preboot-for-drivers-during-initial-deployment-or-does-the-immybot-agent-installer-have-drivers" class="sidebar-link">Does Immy rely on the Windows preboot for drivers during initial deployment, or does the ImmyBot agent installer have drivers?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#does-immy-s-setup-process-support-a-usb-nic-for-wifi-if-so-how-do-we-present-those-drivers-to-immy-or-do-we-even-need-to" class="sidebar-link">Does Immy’s setup process support a USB NIC for WiFi?  If so, how do we present those drivers to Immy, or do we even need to?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#sentinelone-how-do-we-define-which-site-immy-bot-places-the-agent-in-during-installation-of-the-s1-agent" class="sidebar-link">SentinelOne - How do we define which site Immy.Bot places the agent in during installation of the S1 agent?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#are-there-any-repository-limits-for-software-deployments-either-to-the-size-of-custom-software-or-number-of-custom-installers-we-can-upload" class="sidebar-link">Are there any repository limits for software deployments?  Either to the size of custom software or number of custom installers we can upload?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#employee-profile-caching-during-on-boarding-is-this-supported-if-so-how" class="sidebar-link">Employee profile caching during on-boarding - is this supported?  If so/how?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#for-purchasing-immy-do-you-guys-prefer-credit-card-or-invoice-would-you-rather-us-pay-monthly-or-can-we-pay-all-upfront" class="sidebar-link">For purchasing Immy, do you guys prefer Credit card or invoice? Would you rather us pay monthly, or can we pay all upfront?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#is-immy-able-to-group-devices-and-then-do-role-based-deployments-to-them-i-assume-this-is-done-by-tags" class="sidebar-link">Is Immy able to group devices and then do role based deployments to them? I assume this is done by tags?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#bitlocker-does-this-write-the-key-to-azure-ad-by-chance" class="sidebar-link">BitLocker - does this write the key to Azure AD by chance?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#is-immy-able-to-reset-windows-wipe-and-reload-a-computer" class="sidebar-link">Is Immy able to reset Windows / Wipe and Reload a computer?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#immybot-agent-logs-show-an-error-of-the-specified-sas-token-is-expired" class="sidebar-link">ImmyBot Agent logs show an error of &quot;The specified SAS token is expired&quot;</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#what-are-trusted-manufacturers" class="sidebar-link">What are trusted manufacturers?</a></li><li class="sidebar-sub-header"><a href="/FAQ.html#can-i-embed-the-immyagent-into-an-image" class="sidebar-link">Can I embed the ImmyAgent into an image?</a></li></ul></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Advanced</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/scripts.html" class="sidebar-link">Scripting Guide</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/scripts.html#best-practices" class="sidebar-link">Best Practices</a></li><li class="sidebar-sub-header"><a href="/scripts.html#script-types" class="sidebar-link">Script Types</a></li><li class="sidebar-sub-header"><a href="/scripts.html#script-execution-contexts" class="sidebar-link">Script Execution Contexts</a></li><li class="sidebar-sub-header"><a href="/scripts.html#variables" class="sidebar-link">Variables</a></li><li class="sidebar-sub-header"><a href="/scripts.html#scripting-frequently-asked-questions" class="sidebar-link">Scripting Frequently Asked Questions</a></li><li class="sidebar-sub-header"><a href="/scripts.html#configuration-task-helper-functions" class="sidebar-link">Configuration Task Helper Functions</a></li><li class="sidebar-sub-header"><a href="/scripts.html#dynamic-parameters" class="sidebar-link">Dynamic Parameters</a></li></ul></li><li><a href="/immy-commands.html" class="sidebar-link">Metascripts / Cloud Scripts</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/immy-commands.html#example" class="sidebar-link">Example</a></li><li class="sidebar-sub-header"><a href="/immy-commands.html#output" class="sidebar-link">Output</a></li><li class="sidebar-sub-header"><a href="/immy-commands.html#cloud-scripts" class="sidebar-link">Cloud Scripts</a></li><li class="sidebar-sub-header"><a href="/immy-commands.html#common-commands" class="sidebar-link">Common Commands</a></li><li class="sidebar-sub-header"><a href="/immy-commands.html#metascript-commands" class="sidebar-link">Metascript Commands</a></li><li class="sidebar-sub-header"><a href="/immy-commands.html#filterscript-commands" class="sidebar-link">Filterscript Commands</a></li><li class="sidebar-sub-header"><a href="/immy-commands.html#software-auto-update-commands" class="sidebar-link">Software Auto Update Commands</a></li><li class="sidebar-sub-header"><a href="/immy-commands.html#cw-automate-commands" class="sidebar-link">CW Automate Commands</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Integrations</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/build-your-own-integration.html" aria-current="page" class="active sidebar-link">Build Your Own Integrations</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/build-your-own-integration.html#build-your-own-integrations" class="sidebar-link">Build Your Own Integrations</a></li></ul></li><li><a href="/connectwise-automate-integration-setup.html" class="sidebar-link">ConnectWise Automate</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/connectwise-automate-integration-setup.html#create-immybot-role" class="sidebar-link">Create ImmyBot Role</a></li><li class="sidebar-sub-header"><a href="/connectwise-automate-integration-setup.html#create-immybot-user" class="sidebar-link">Create ImmyBot User</a></li><li class="sidebar-sub-header"><a href="/connectwise-automate-integration-setup.html#enable-google-mfa-for-immybot-user" class="sidebar-link">Enable Google MFA for ImmyBot User</a></li><li class="sidebar-sub-header"><a href="/connectwise-automate-integration-setup.html#add-rmm-link-for-cw-automate" class="sidebar-link">Add RMM Link for CW Automate</a></li><li class="sidebar-sub-header"><a href="/connectwise-automate-integration-setup.html#import-your-customers" class="sidebar-link">Import your customers</a></li></ul></li><li><a href="/connectwise-control-integration-setup.html" class="sidebar-link">ConnectWise Control</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/connectwise-control-integration-setup.html#install-immybot-extension-for-control" class="sidebar-link">Install ImmyBot Extension for Control</a></li><li class="sidebar-sub-header"><a href="/connectwise-control-integration-setup.html#create-rmmlink-for-control" class="sidebar-link">Create RMMLink for Control</a></li><li class="sidebar-sub-header"><a href="/connectwise-control-integration-setup.html#import-your-customers" class="sidebar-link">Import your customers</a></li><li class="sidebar-sub-header"><a href="/connectwise-control-integration-setup.html#troubleshooting" class="sidebar-link">Troubleshooting</a></li></ul></li><li><a href="/connectwise-manage-integration-setup.html" class="sidebar-link">ConnectWise Manage</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/connectwise-manage-integration-setup.html#create-an-immybot-role-with-the-following-permissions" class="sidebar-link">Create an ImmyBot Role with the following permissions</a></li><li class="sidebar-sub-header"><a href="/connectwise-manage-integration-setup.html#create-an-api-member" class="sidebar-link">Create an API Member</a></li><li class="sidebar-sub-header"><a href="/connectwise-manage-integration-setup.html#plugin-the-api-keys-in-immybot" class="sidebar-link">Plugin the API Keys in ImmyBot</a></li></ul></li><li><a href="/ncentral-integration-setup.html" class="sidebar-link">N-Central Integration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ncentral-integration-setup.html#create-immybot-role-in-n-central" class="sidebar-link">Create ImmyBot Role in N-Central</a></li><li class="sidebar-sub-header"><a href="/ncentral-integration-setup.html#create-immybot-user-in-n-central" class="sidebar-link">Create ImmyBot user in N-Central</a></li><li class="sidebar-sub-header"><a href="/ncentral-integration-setup.html#login-to-the-new-immybot-user-to-get-mfa-code-and-accept-eula" class="sidebar-link">Login to the new ImmyBot user to get MFA code and accept EULA</a></li><li class="sidebar-sub-header"><a href="/ncentral-integration-setup.html#add-integration-for-n-central" class="sidebar-link">Add integration for N-Central</a></li><li class="sidebar-sub-header"><a href="/ncentral-integration-setup.html#import-your-customers" class="sidebar-link">Import your customers</a></li><li class="sidebar-sub-header"><a href="/ncentral-integration-setup.html#troubleshooting" class="sidebar-link">Troubleshooting</a></li></ul></li><li><a href="/azure-graph-permissions-setup.html" class="sidebar-link">AzureAD/365 Graph Permissions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/azure-graph-permissions-setup.html#default" class="sidebar-link">Default</a></li><li class="sidebar-sub-header"><a href="/azure-graph-permissions-setup.html#custom" class="sidebar-link">Custom</a></li></ul></li><li><a href="/halo-integration-setup.html" class="sidebar-link">HaloPSA</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/halo-integration-setup.html#create-an-immybot-application-under-config-integrations-api-applications" class="sidebar-link">Create an ImmyBot Application under /config/integrations/api/applications</a></li><li class="sidebar-sub-header"><a href="/halo-integration-setup.html#permissions" class="sidebar-link">Permissions:</a></li><li class="sidebar-sub-header"><a href="/halo-integration-setup.html#plug-in-the-client-id-and-client-secret-in-immybot" class="sidebar-link">Plug in the Client ID and Client Secret in ImmyBot</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="build-your-own-integrations"><a href="#build-your-own-integrations" class="header-anchor">#</a> Build Your Own Integrations</h2> <p>The goal of this feature is primarily for our own use to more rapidly implement integrations with other RMMs and PSA, but we have opened it up for you to create your own integrations as well.</p> <p><img src="https://github.com/immense/immybot-documentation/assets/31077619/ebdbfab0-a149-4d0d-8e56-cad8291df879" alt="image"></p> <p><img src="https://github.com/immense/immybot-documentation/assets/31077619/f5a9d865-2a7d-4843-9a58-298557dd674d" alt="image"></p> <h4 id="example-sentinelone-implemented-in-global-already"><a href="#example-sentinelone-implemented-in-global-already" class="header-anchor">#</a> Example: SentinelOne (Implemented in Global already)</h4> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token variable">$Integration</span> = <span class="token function">New-DynamicIntegration</span> <span class="token operator">-</span>Init <span class="token punctuation">{</span>
    <span class="token keyword">param</span><span class="token punctuation">(</span>
        <span class="token namespace">[Parameter(Mandatory)]</span>
        <span class="token namespace">[Uri]</span><span class="token variable">$S1Uri</span><span class="token punctuation">,</span>
        <span class="token namespace">[Parameter(Mandatory)]</span>
        <span class="token comment"># [DisplayName(&quot;API Key&quot;)]</span>
        <span class="token namespace">[Password(StripValue = $true)]</span>
        <span class="token variable">$S1ApiKey</span>
    <span class="token punctuation">)</span>
    <span class="token variable">$providerTypeFormData</span> <span class="token punctuation">|</span> <span class="token function">Write-Variable</span>
    <span class="token function">Import-Module</span> SentinelOne    
    <span class="token function">Get-Command</span> <span class="token operator">-</span>Module SentinelOne <span class="token punctuation">|</span> <span class="token function">Out-String</span> <span class="token punctuation">|</span> <span class="token function">Write-Host</span>
    <span class="token variable">$S1AuthHeader</span> = Connect<span class="token operator">-</span>S1API <span class="token operator">-</span>S1Uri <span class="token variable">$S1Uri</span> <span class="token operator">-</span>S1APIToken <span class="token variable">$S1ApiKey</span>
    <span class="token variable">$IntegrationContext</span><span class="token punctuation">.</span>S1Uri = <span class="token variable">$S1Uri</span>
    <span class="token variable">$IntegrationContext</span><span class="token punctuation">.</span>S1ApiKey = <span class="token variable">$S1ApiKey</span>
    <span class="token variable">$IntegrationContext</span><span class="token punctuation">.</span>AuthHeader = <span class="token variable">$S1AuthHeader</span>
    
    <span class="token namespace">[OpResult]</span>::Ok<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token operator">-</span>HealthCheck <span class="token punctuation">{</span>
    <span class="token namespace">[CmdletBinding()]</span>
    <span class="token namespace">[OutputType([HealthCheckResult])]</span>
    <span class="token keyword">param</span><span class="token punctuation">(</span>
        
    <span class="token punctuation">)</span>
    <span class="token comment"># todo: implement health check</span>
    <span class="token keyword">return</span> <span class="token function">New-HealthyResult</span>
<span class="token punctuation">}</span>

<span class="token comment"># supports listing clients</span>
<span class="token variable">$Integration</span> <span class="token punctuation">|</span> <span class="token function">Add-DynamicIntegrationCapability</span> <span class="token operator">-</span>Interface ISupportsListingClients <span class="token operator">-</span>GetClients <span class="token punctuation">{</span>
    <span class="token namespace">[CmdletBinding()]</span>
    <span class="token namespace">[OutputType([Immybot.Backend.Domain.Providers.IProviderClientDetails[]])]</span>
    <span class="token keyword">param</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># return a list of clients for this integration using the New-IntegrationClient cmdlet</span>
    <span class="token function">Import-Module</span> SentinelOne
    Get<span class="token operator">-</span>S1Site <span class="token operator">-</span>Verbose <span class="token punctuation">|</span> <span class="token function">ForEach-Object</span> <span class="token punctuation">{</span>
        <span class="token function">New-IntegrationClient</span> <span class="token operator">-</span>ClientId <span class="token variable">$_</span><span class="token punctuation">.</span>Id <span class="token operator">-</span>ClientName <span class="token variable">$_</span><span class="token punctuation">.</span>Name
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment"># supports listing agents</span>

<span class="token variable">$Integration</span> <span class="token punctuation">|</span> <span class="token function">Add-DynamicIntegrationCapability</span> <span class="token operator">-</span>Interface ISupportsListingAgents <span class="token operator">-</span>GetAgents <span class="token punctuation">{</span>
    <span class="token namespace">[CmdletBinding()]</span>
    <span class="token namespace">[OutputType([Immybot.Backend.Domain.Providers.IProviderAgentDetails[]])]</span>
    <span class="token keyword">param</span><span class="token punctuation">(</span>
        <span class="token namespace">[Parameter()]</span>
        <span class="token namespace">[string[]]</span><span class="token variable">$clientIds</span> = <span class="token variable">$null</span>
    <span class="token punctuation">)</span>
    <span class="token function">Import-Module</span> SentinelOne
    Get<span class="token operator">-</span>S1Agent <span class="token operator">-</span>Verbose <span class="token punctuation">|</span> <span class="token function">ForEach-Object</span> <span class="token punctuation">{</span>
        <span class="token function">New-IntegrationAgent</span> <span class="token operator">-</span>Name <span class="token variable">$_</span><span class="token punctuation">.</span>computerName <span class="token operator">-</span>SerialNumber <span class="token variable">$_</span><span class="token punctuation">.</span>serialNumber <span class="token operator">-</span>OSName <span class="token variable">$_</span><span class="token punctuation">.</span>osName <span class="token operator">-</span>Manufacturer <span class="token variable">$_</span><span class="token punctuation">.</span>modelName <span class="token operator">-</span>ClientId <span class="token variable">$_</span><span class="token punctuation">.</span>siteId <span class="token operator">-</span>AgentId <span class="token variable">$_</span><span class="token punctuation">.</span>uuid <span class="token operator">-</span>IsOnline <span class="token boolean">$true</span> <span class="token operator">-</span>AgentVersion <span class="token variable">$_</span><span class="token punctuation">.</span>agentVersion <span class="token operator">-</span>SupportsRunningScripts <span class="token boolean">$false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment"># supports inventory identification</span>

<span class="token variable">$Integration</span> <span class="token punctuation">|</span> <span class="token function">Add-DynamicIntegrationCapability</span> <span class="token operator">-</span>Interface ISupportsInventoryIdentification <span class="token operator">-</span>GetInventoryScript <span class="token punctuation">{</span>
    <span class="token namespace">[CmdletBinding()]</span>
    <span class="token keyword">param</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">Invoke-ImmyCommand</span> <span class="token punctuation">{</span>
        <span class="token comment"># implement a script block that will be ran on a computer to retrieve the agent identifier for this integration.</span>
        <span class="token variable">$path</span> = <span class="token function">Resolve-Path</span>  <span class="token string">&quot;C:\Program Files\SentinelOne\Sentinel Agent*\SentinelCtl.exe&quot;</span>
        <span class="token punctuation">.</span> <span class="token variable">$path</span><span class="token punctuation">.</span>Path agent_id
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment"># supports retrieving a tenant install token</span>

<span class="token variable">$Integration</span> <span class="token punctuation">|</span>  <span class="token function">Add-DynamicIntegrationCapability</span> <span class="token operator">-</span>Interface ISupportsTenantInstallToken <span class="token operator">-</span>GetTenantInstallToken <span class="token punctuation">{</span>
    <span class="token namespace">[CmdletBinding()]</span>
    <span class="token namespace">[OutputType([System.String])]</span>
    <span class="token keyword">param</span><span class="token punctuation">(</span>
        <span class="token namespace">[Parameter(Mandatory=$true)]</span>
        <span class="token namespace">[System.String]</span><span class="token variable">$clientId</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">&quot;implement me&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment"># supports retrieving a tenant uninstall token</span>

<span class="token variable">$Integration</span> <span class="token punctuation">|</span> <span class="token function">Add-DynamicIntegrationCapability</span> <span class="token operator">-</span>Interface ISupportsTenantUninstallToken <span class="token operator">-</span>GetTenantUninstallToken <span class="token punctuation">{</span>
    <span class="token namespace">[CmdletBinding()]</span>
    <span class="token namespace">[OutputType([System.String])]</span>
    <span class="token keyword">param</span><span class="token punctuation">(</span>
        <span class="token namespace">[Parameter(Mandatory=$true)]</span>
        <span class="token namespace">[System.String]</span><span class="token variable">$clientId</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">&quot;implement me&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">return</span> <span class="token variable">$Integration</span>
</code></pre></div><p><img src="https://github.com/immense/immybot-documentation/assets/31077619/67ea8b15-0ae9-44e6-b3e0-9de250b15010" alt="image"></p> <h4 id="dynamic-integration-capabilities"><a href="#dynamic-integration-capabilities" class="header-anchor">#</a> Dynamic Integration Capabilities</h4> <ul><li>List Customers from the remote system so they can be mapped in the ImmyBot UI</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/immense/immybot-documentation/edit/main/src/build-your-own-integration.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/12/2023, 8:42:25 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/immy-commands.html" class="prev">
        Metascripts / Cloud Scripts
      </a></span> <span class="next"><a href="/connectwise-automate-integration-setup.html">
        ConnectWise Automate
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.211bfa0f.js" defer></script><script src="/assets/js/3.b0bc7a00.js" defer></script><script src="/assets/js/19.14059d57.js" defer></script>
  </body>
</html>
