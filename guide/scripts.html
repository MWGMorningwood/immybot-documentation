<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Scripts | ImmyDocs</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.c79fdf9a.css" as="style"><link rel="preload" href="/assets/js/app.c535ddfb.js" as="script"><link rel="preload" href="/assets/js/3.4b19fe57.js" as="script"><link rel="preload" href="/assets/js/18.0dde53d0.js" as="script"><link rel="prefetch" href="/assets/js/10.f7820eec.js"><link rel="prefetch" href="/assets/js/11.969d6d55.js"><link rel="prefetch" href="/assets/js/12.230d2132.js"><link rel="prefetch" href="/assets/js/13.0413455a.js"><link rel="prefetch" href="/assets/js/14.9460ea05.js"><link rel="prefetch" href="/assets/js/15.fd6b7b50.js"><link rel="prefetch" href="/assets/js/16.870283f6.js"><link rel="prefetch" href="/assets/js/17.4fa11e8d.js"><link rel="prefetch" href="/assets/js/19.464251ce.js"><link rel="prefetch" href="/assets/js/20.18b42a86.js"><link rel="prefetch" href="/assets/js/4.d6289c8f.js"><link rel="prefetch" href="/assets/js/5.1a7a4e67.js"><link rel="prefetch" href="/assets/js/6.4cb87efa.js"><link rel="prefetch" href="/assets/js/7.dcd5ed84.js"><link rel="prefetch" href="/assets/js/8.73c2ebd1.js"><link rel="prefetch" href="/assets/js/9.0c0bbd84.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.f08c4fa7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c79fdf9a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">ImmyDocs</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/introduction.html" class="nav-link">
  Guide
</a></div> <a href="https://github.com/immense/immybot-documentation" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/introduction.html" class="nav-link">
  Guide
</a></div> <a href="https://github.com/immense/immybot-documentation" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>What's New</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/releases.html" class="sidebar-link">Releases</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Getting Started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/guide/scripts.html" aria-current="page" class="active sidebar-link">Scripts</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/scripts.html#script-types" class="sidebar-link">Script Types</a></li><li class="sidebar-sub-header"><a href="/guide/scripts.html#script-execution-contexts" class="sidebar-link">Script Execution Contexts</a></li><li class="sidebar-sub-header"><a href="/guide/scripts.html#variables" class="sidebar-link">Variables</a></li></ul></li><li><a href="/guide/immy-commands.html" class="sidebar-link">Executing Scripts on the Server</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Integrations</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/connectwise-automate-integration-setup.html" class="sidebar-link">ConnectWise Automate Integration</a></li><li><a href="/guide/connectwise-control-integration-setup.html" class="sidebar-link">ConnectWise Control Integration</a></li><li><a href="/guide/connectwise-manage-integration-setup.html" class="sidebar-link">ConnectWise Manage Integration</a></li><li><a href="/guide/csp-preconsent-instructions.html" class="sidebar-link">Azure CSP Preconsent Instructions</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="scripts"><a href="#scripts" class="header-anchor">#</a> Scripts</h1> <h2 id="script-types"><a href="#script-types" class="header-anchor">#</a> Script Types</h2> <p>A script will have a specific type.  This type determines which variables and commands will be available in the script.</p> <h3 id="software-detection"><a href="#software-detection" class="header-anchor">#</a> Software Detection</h3> <p>These scripts  <strong>must return a string that will cast to a valid <code>System.Version</code></strong>.
Returning an actual <code>System.Version</code> will fail.
For example</p> <div class="language- extra-class"><pre class="language-text"><code>$version = [String]&quot;1.2.3&quot;
return $version
</code></pre></div><p>will work, but currently</p> <div class="language- extra-class"><pre class="language-text"><code>$version = [System.Version]&quot;1.2.3&quot;
return $version
</code></pre></div><p>will fail.</p> <p>Software Detection scripts are used to determine whether an existing software is present and what version it may be.</p> <h3 id="software-auto-update"><a href="#software-auto-update" class="header-anchor">#</a> Software Auto Update</h3> <p>These scripts are useful for automatically adding new versions for a software.
Script should return a <code>$SoftwareVersion</code> object.</p> <div class="language- extra-class"><pre class="language-text"><code>$SoftwareVersion = @{}
$SoftwareVersion.url = $LatestPackage.OriginFile.OriginUri
$SoftwareVersion.displayVersion = $VersionFromMsi
return $SoftwareVersion
</code></pre></div><h3 id="software-version-action"><a href="#software-version-action" class="header-anchor">#</a> Software Version Action</h3> <p>These scripts an be used on a software version for installation, post-installation, uninstallation, post-uninstallation, testing, and upgrade scripts.</p> <h3 id="maintenance-task"><a href="#maintenance-task" class="header-anchor">#</a> Maintenance Task</h3> <p>These scripts are available only on maintenance tasks.</p> <h3 id="metascript-deployment-target"><a href="#metascript-deployment-target" class="header-anchor">#</a> Metascript Deployment Target</h3> <p>These scripts are used on deployments as a target.</p> <p>They <strong>must return <code>$true</code> or <code>$false</code></strong>.</p> <p>A value of <code>$true</code> indicates that the computer applies to this deployment.  A value of <code>$false</code> indicates that the computer does not apply to this deployment.</p> <h3 id="filter-script-deployment-target"><a href="#filter-script-deployment-target" class="header-anchor">#</a> Filter Script Deployment Target</h3> <p>These scripts are used on deployments as a target.</p> <p>They <strong>must return a <code>Computer[]</code> array</strong>.</p> <p>The deployment will only apply to computers specified in the returned array.</p> <h2 id="script-execution-contexts"><a href="#script-execution-contexts" class="header-anchor">#</a> Script Execution Contexts</h2> <p>A script will have a specific execution context.  This context determines how the script gets run.</p> <h3 id="system"><a href="#system" class="header-anchor">#</a> System</h3> <p>The script runs on the computer under the system user.</p> <h3 id="user"><a href="#user" class="header-anchor">#</a> User</h3> <p>The script runs on the computer under a specific user.</p> <h3 id="metascript"><a href="#metascript" class="header-anchor">#</a> Metascript</h3> <p>The script runs on the server in the context of a specific computer.</p> <h3 id="cloudscript"><a href="#cloudscript" class="header-anchor">#</a> Cloudscript</h3> <p>The script runs on the server in the context of a specific tenant.</p> <h2 id="variables"><a href="#variables" class="header-anchor">#</a> Variables</h2> <p>All variables are strings, but are castable to the datatypes specified.</p> <p>At this time, the variables are string replacements.</p> <p>Avoid setting these variables yourself or having variables with similar names.</p> <h3 id="azuretenantid"><a href="#azuretenantid" class="header-anchor">#</a> $AzureTenantId</h3> <p>`[string] The Azure Principal Id of the computer's tenant.</p> <ul><li>Software Detection</li> <li>Software Auto Update</li> <li>Software Version Action</li> <li>Maintenance Task Setter</li> <li>Metascript Deployment Target</li> <li>Filterscript Deployment Target</li></ul> <h3 id="computername"><a href="#computername" class="header-anchor">#</a> $ComputerName</h3> <p><code>[string]</code> Name of the computer the session is running against</p> <h4 id="accessible-in"><a href="#accessible-in" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Detection</li> <li>Software Auto Update</li> <li>Software Version Action</li> <li>Maintenance Task Setter</li> <li>Metascript Deployment Target</li></ul> <h3 id="detectionstring"><a href="#detectionstring" class="header-anchor">#</a> $DetectionString</h3> <p><code>[string]</code> String used to find the software in the registry</p> <h4 id="accessible-in-2"><a href="#accessible-in-2" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Version Action</li></ul> <h3 id="displayname"><a href="#displayname" class="header-anchor">#</a> $DisplayName</h3> <p><code>[string]</code> Display Name of the Software Version</p> <h4 id="accessible-in-3"><a href="#accessible-in-3" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Version Action</li></ul> <h3 id="displayversion"><a href="#displayversion" class="header-anchor">#</a> $DisplayVersion</h3> <p><code>[System.Version]</code> version of the software being deployed <code>1.2.3.4</code></p> <h4 id="accessible-in-4"><a href="#accessible-in-4" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Version Action</li></ul> <h3 id="installerfile"><a href="#installerfile" class="header-anchor">#</a> $InstallerFile</h3> <p><code>[string]</code> Full path to the installer file itself</p> <h4 id="accessible-in-5"><a href="#accessible-in-5" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Version Action</li></ul> <h3 id="installerfolder"><a href="#installerfolder" class="header-anchor">#</a> $InstallerFolder</h3> <p><code>[string]</code> Full path to the folder the installer file can be found in</p> <h4 id="accessible-in-6"><a href="#accessible-in-6" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Version Action</li></ul> <h3 id="installerlogfile"><a href="#installerlogfile" class="header-anchor">#</a> $InstallerLogFile</h3> <p><code>[string]</code> Suggested full path for log file. When used Immy will get the content of this file for you and display it in our logs.</p> <h4 id="accessible-in-7"><a href="#accessible-in-7" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Version Action</li></ul> <h3 id="isportable"><a href="#isportable" class="header-anchor">#</a> $IsPortable</h3> <p><code>[boolean]</code> 'True' or 'False' indicating whether the current computer is a laptop/tablet</p> <h4 id="accessible-in-8"><a href="#accessible-in-8" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Detection</li> <li>Software Auto Update</li> <li>Software Version Action</li> <li>Maintenance Task</li> <li>Metascript Deployment Target</li></ul> <h3 id="licensefilepath"><a href="#licensefilepath" class="header-anchor">#</a> $LicenseFilePath</h3> <p><code>[string]</code> Full path to the license file for the software (from the Deployment) Note: Software must be marked 'Licensed' and Software Version must indicate that it requires a License File and an Deployment applicable to this user/computer must specify a license file.</p> <h4 id="accessible-in-9"><a href="#accessible-in-9" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Version Action</li></ul> <h3 id="licensevalue"><a href="#licensevalue" class="header-anchor">#</a> $LicenseValue</h3> <p><code>[string]</code> From Deployment. Used for software that requires a key. Alternative usage could be to use this to hold additional command line parameters to customize installation for different computers. Software must be marked as Licensed for this variable to be replaced.</p> <h4 id="accessible-in-10"><a href="#accessible-in-10" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Version Action</li></ul> <h3 id="method"><a href="#method" class="header-anchor">#</a> $Method</h3> <p><code>[string]</code> Will be a value consisting of <code>[ &quot;get&quot; | &quot;set&quot; | &quot;test&quot; ]</code> that can be used in maintenance task scripts.</p> <h4 id="accessible-in-11"><a href="#accessible-in-11" class="header-anchor">#</a> Accessible in</h4> <ul><li>Maintenance Task</li></ul> <h3 id="primarypersonazureprincipalid"><a href="#primarypersonazureprincipalid" class="header-anchor">#</a> $PrimaryPersonAzurePrincipalId</h3> <p><code>[Guid]</code> User's unique identifier in Azure</p> <h4 id="accessible-in-12"><a href="#accessible-in-12" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Detection</li> <li>Software Auto Update</li> <li>Software Version Action</li> <li>Maintenance Task</li> <li>Metascript Deployment Target</li></ul> <h3 id="primarypersonemail"><a href="#primarypersonemail" class="header-anchor">#</a> $PrimaryPersonEmail</h3> <p><code>[string]</code> Mail Address of the person that most frequently uses this computer</p> <h4 id="accessible-in-13"><a href="#accessible-in-13" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Detection</li> <li>Software Auto Update</li> <li>Software Version Action</li> <li>Maintenance Task</li> <li>Metascript Deployment Target</li></ul> <h3 id="productcode"><a href="#productcode" class="header-anchor">#</a> $ProductCode</h3> <p><code>[string]</code> Product code of the version being deployed</p> <h4 id="accessible-in-14"><a href="#accessible-in-14" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Version Action</li></ul> <h3 id="software"><a href="#software" class="header-anchor">#</a> $Software</h3> <p><code>[Software]</code> The software that is running the auto update script.</p> <h4 id="accessible-in-15"><a href="#accessible-in-15" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Auto Update</li></ul> <h3 id="softwarename"><a href="#softwarename" class="header-anchor">#</a> $SoftwareName</h3> <p>`[string] Name of the Software</p> <h4 id="accessible-in-16"><a href="#accessible-in-16" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Detection</li> <li>Software Auto Update</li></ul> <h3 id="softwareversions"><a href="#softwareversions" class="header-anchor">#</a> $SoftwareVersions</h3> <p><code>[ICollection&lt;SoftwareVersion&gt;]</code> The software versions of the software.</p> <h4 id="accessible-in-17"><a href="#accessible-in-17" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Auto Update</li></ul> <h3 id="tenantname"><a href="#tenantname" class="header-anchor">#</a> $TenantName</h3> <p><code>[string]</code> Name of company the computer belongs to</p> <h4 id="accessible-in-18"><a href="#accessible-in-18" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Detection</li> <li>Software Auto Update</li> <li>Software Version Action</li> <li>Maintenance Task</li> <li>Metascript Deployment Target</li></ul> <h3 id="upgradecode"><a href="#upgradecode" class="header-anchor">#</a> $UpgradeCode</h3> <p><code>[string]</code> Upgrade code of the software</p> <h4 id="accessible-in-19"><a href="#accessible-in-19" class="header-anchor">#</a> Accessible in</h4> <ul><li>Software Detection</li> <li>Software Auto Update</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/immense/immybot-documentation/edit/master/guide/scripts.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/3/2021, 5:13:43 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/introduction.html" class="prev">
        Introduction
      </a></span> <span class="next"><a href="/guide/immy-commands.html">
        Executing Scripts on the Server
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c535ddfb.js" defer></script><script src="/assets/js/3.4b19fe57.js" defer></script><script src="/assets/js/18.0dde53d0.js" defer></script>
  </body>
</html>
